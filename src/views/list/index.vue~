<template>
<n-data-table remote
:data="data" :columns="columns"
    @update:checked-row-keys="handleCheck" :row-key="(row)=>row.id"/>
    <n-button @click="gotobatch">BATCH</n-button>
</template>

<script setup>
import { NButton, NDataTable } from "naive-ui";
import { h, ref } from "vue";

import {useRoute,useRouter} from "vue-router"
const route=useRoute(),router=useRouter()



const data=ref([])

const columns=[{
    type:"selection"
},{
    type:"expand",
    renderExpand(row){
        return h("div",{
        },{default:()=>row.q})
    }
},{
    title:"submit time",
    render(row){
        return h("p",{},row.timestamp)
    }
},{
    title:"extra",
    key:"extra"
},{
    title:"view",
    render(row){
        return h(NButton,{
            text:true,
            onClick:()=>{
                router.push("/view/"+row.id)
            }
        },{default:()=>"View"})
    }
}]

const checkedRowKeysRef=ref([])
const handleCheck=(rowKeys) =>{
        checkedRowKeysRef.value = rowKeys;
        console.log(rowKeys);
      }

      ,gotobatch=()=>{
        router.push("/batch/"+checkedRowKeysRef.value.join(","))
      }




fetch("/api/list/v1",{method:"POST"}).then(v=>v.json()).then(v=>{data.value=v})

</script>

<style>

</style>